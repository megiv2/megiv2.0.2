<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>megilism v2.0 | akses rahsia</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <style>
      @font-face {
        font-family: 'Glitch';
        src: local('Courier New');
      }

      .glitch {
        font-family: 'Glitch';
        animation: flicker 3s linear forwards;
      }

      @keyframes flicker {
        0% {
          opacity: 0;
          transform: translateX(-10px);
        }
        100% {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .typewriter {
        overflow: hidden;
        border-right: 0.15em solid white;
        animation: typing 15s steps(60, end) forwards;
        font-family: 'Source Code Pro', monospace;
        white-space: nowrap;
        width: fit-content;
        max-width: 100%;
      }

      @keyframes typing {
        from {
          width: 0;
        }
        to {
          width: 100%;
        }
      }

      .font-source {
        font-family: 'Source Code Pro', monospace;
      }

      .loading-dots::after {
        content: '';
        display: inline-block;
        animation: dots 1s steps(4, end) infinite;
        width: 1ch;
        text-align: left;
      }

      @keyframes dots {
        0% {
          content: '';
        }
        25% {
          content: '.';
        }
        50% {
          content: '..';
        }
        75% {
          content: '...';
        }
        100% {
          content: '';
        }
      }

      #logText {
        max-width: 90vw;
        overflow-wrap: break-word;
        text-align: center;
      }

      #logEntry {
        min-height: 100vh;
      }
    </style>
    <link
      href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@1,400&display=swap"
      rel="stylesheet"
    />
  </head>

  <body class="bg-black text-white overflow-hidden">
    <!-- LANDING PAGE -->
    <section
      id="landing"
      class="w-screen h-screen relative flex flex-col justify-center items-center"
    >
      <video
        id="bg-video"
        src="/bg.mp4"
        class="absolute top-0 left-0 w-full h-full object-cover z-0"
        autoplay
        muted
        playsinline
      ></video>
      <div class="z-10 text-center px-4">
        <h1
          class="text-2xl md:text-4xl glitch mb-4 font-source italic"
        >
          megilism v2.0 | akses rahsia
        </h1>
        <p class="mb-4 font-source italic">
          tulis apa saja memori, trauma atau apa yang kau mahu.<br />takkan
          disimpan, terus lenyap dari sini.
        </p>
        <textarea
          id="inputText"
          class="bg-black bg-opacity-50 border border-gray-600 p-2 rounded-md w-full max-w-md h-24 mb-4"
          placeholder="..."
        ></textarea>
        <button
          id="releaseBtn"
          class="bg-white text-black font-bold py-2 px-4 rounded hover:bg-gray-200"
          onclick="handleRelease()"
        >
          release
        </button>
      </div>
    </section>

    <!-- LOADING SECTION -->
    <section
      id="loading"
      class="w-screen h-screen bg-black hidden flex justify-center items-center"
    >
      <div class="text-center">
        <p class="text-lg font-mono loading-dots">loading</p>
      </div>
    </section>

    <!-- LOG ENTRY SECTION -->
    <section
      id="logEntry"
      class="w-screen hidden flex justify-center items-center px-4"
    >
      <p
        id="logText"
        class="text-center text-lg font-mono italic"
      ></p>
      <audio id="logAudio" src="/KoyakWebsite.mp3"></audio>
    </section>

    <!-- SCRIPT -->
    <script>
      if (!localStorage.getItem('log_counter')) {
        localStorage.setItem('log_counter', 32);
      }

      function handleRelease() {
        let count = parseInt(localStorage.getItem('log_counter'));
        count += 1;
        localStorage.setItem('log_counter', count);

        const message =
          "log entry " +
          String(count).padStart(3, "0") +
          " berjaya dihantar. emosi sedang diproses....";

        const logText = document.getElementById("logText");
        logText.classList.remove("typewriter");
        void logText.offsetWidth;
        logText.innerText = "";

        document.getElementById("landing").style.display = "none";
        document.getElementById("loading").style.display = "flex";

        setTimeout(() => {
          document.getElementById("loading").style.display = "none";
          document.getElementById("logEntry").style.display = "flex";

          logText.innerText = message;
          logText.classList.add("typewriter");

          const audio = document.getElementById("logAudio");
          audio.currentTime = 0;
          audio.play();

          audio.onended = () => {
            document.getElementById("logEntry").style.display = "none";
            document.getElementById("landing").style.display = "flex";
            document.getElementById("inputText").value = "";
          };
        }, 2500);
      }
    </script>
  </body>
</html>
